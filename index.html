<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat - Lo-fi Prototype</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            height: 100vh;
        }

        body.prototype-mode {
            overflow: hidden;
        }

        /* Main Container */
        .app-container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        /* Side Navigation */
        .side-nav {
            width: 280px;
            height: 100vh;
            background-color: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            transition: width 0.3s ease;
            overflow-y: auto;
            flex-shrink: 0;
            width: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        /* Mobile view - remove rounded corners */
        .mobile-view .side-nav {
            border-radius: 0;
        }

        .side-nav.active {
            width: 280px;
        }

        .nav-header {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-content {
            flex: 1;
            overflow-y: auto;
        }

        .nav-item {
            padding: 8px 20px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .nav-item:hover {
            background-color: #f5f5f5;
        }

        .nav-section-title {
            padding: 16px 20px 8px;
            font-size: 14px;
            text-transform: uppercase;
            color: #666;
            font-weight: 600;
        }

        /* Documentation Cards */
        .doc-card {
            padding: 12px;
            background-color: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            height: 72px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .doc-card:hover {
            background-color: #e9ecef;
        }

        .doc-card-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .doc-card-subtitle {
            font-size: 12px;
            color: #666;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            line-clamp: 3;
            overflow: hidden;
        }


        /* Chat Container */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100vh;
            position: relative;
        }

        /* Chat Header */
        .chat-header {
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }

        .chat-header-actions {
            display: none;
            align-items: center;
            gap: 12px;
        }

        .has-messages .chat-header-actions {
            display: flex;
        }

        .header-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background-color: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .header-icon:hover {
            background-color: rgba(0,0,0,0.05);
        }

        /* Move chat header actions down 5px */
        .chat-header-actions {
            transform: translateY(5px);
        }

        .nav-toggle {
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 5px;
            z-index: 100;
            transition: all 0.2s ease;
        }

        .nav-toggle:hover {
            background-color: rgba(0,0,0,0.05);
            border-radius: 6px;
        }

        /* Move nav toggle down 5px */
        .nav-toggle {
            transform: translateY(5px);
        }

        .messages-area {
            flex: 1;
            overflow-y: auto;
            padding: 20px 180px;
            padding-bottom: 140px;
            padding-top: 20px;
            position: relative;
        }

        /* Fade overlay above input - fixed to viewport bottom */
        .chat-container::after {
            content: '';
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 245px; /* 140px input area + 100px additional + 5px */
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.1) 40%, rgba(255, 255, 255, 0.3) 65%, rgba(255, 255, 255, 0.7) 85%, rgba(255, 255, 255, 0.95) 100%);
            pointer-events: none;
            z-index: 10;
        }

        /* Adjust for mobile view */
        .mobile-view .chat-container::after {
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 390px;
        }

        /* Mobile view - reduce padding */
        .mobile-view .messages-area {
            padding: 20px 20px 140px 20px !important;
        }

        .mobile-view .section-nav {
            display: none !important;
        }

        .message {
            margin-bottom: 20px;
        }

        .message-content {
            padding: 12px 16px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .message.user .message-content {
            background-color: #007AFF;
            color: white;
        }

        /* Research Response Styling */
        .research-response .message-content {
            max-width: none;
            padding: 0;
            background-color: transparent;
            box-shadow: none;
        }

        .research-container {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }

        .research-content {
            flex: 1;
        }

        .research-header h1 {
            margin: 0 0 20px 0;
            color: #000;
            font-size: 32px;
            font-weight: 700;
            line-height: 1.2;
        }

        .research-question {
            margin: 0 0 30px 0;
            padding: 16px 20px;
            background-color: #e8e8e8;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            color: #666;
        }

        .research-answer {
            font-size: 16px;
            line-height: 1.6;
            color: #333;
        }

        .research-answer h2 {
            margin: 30px 0 15px 0;
            color: #000;
            font-size: 24px;
            font-weight: 600;
        }

        .research-answer h3 {
            margin: 25px 0 12px 0;
            color: #000;
            font-size: 20px;
            font-weight: 600;
        }

        .research-answer p {
            margin: 0 0 16px 0;
        }

        .research-answer ul {
            margin: 0 0 16px 0;
            padding-left: 24px;
        }

        .research-answer li {
            margin-bottom: 8px;
        }

        /* Section Navigation */
        .section-nav {
            width: 200px;
            position: sticky;
            top: 80px;
            display: none;
        }

        @media (min-width: 1200px) {
            .section-nav {
                display: block;
            }
        }

        .section-nav-title {
            font-size: 12px;
            text-transform: uppercase;
            color: #666;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .section-nav-item {
            padding: 8px 12px;
            margin-bottom: 4px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            color: #666;
            transition: all 0.2s;
        }

        .section-nav-item:hover {
            background-color: #f0f0f0;
            color: #333;
        }

        .section-nav-item.active {
            background-color: #e8f0fe;
            color: #1967d2;
            font-weight: 500;
        }

        /* Input Area */
        .input-container {
            position: fixed;
            bottom: 50%;
            left: 50%;
            transform: translate(-50%, 50%);
            z-index: 50;
            width: 90%;
            max-width: 600px;
            transition: all 0.3s ease;
        }

        /* Input at bottom when messages exist */
        .has-messages .input-container {
            bottom: 20px;
            transform: translateX(-50%);
        }

        .side-nav.active ~ .chat-container .input-container {
            left: calc(50% + 140px);
            margin-left: 10px;
        }

        /* Input positioning with nav active and messages */
        .side-nav.active ~ .chat-container.has-messages .input-container {
            left: calc(50% + 140px);
            margin-left: 10px;
        }

        .input-wrapper {
            max-width: 800px;
            margin: 0 auto;
        }

        .input-box {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: stretch;
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 12px;
            min-height: 100px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .file-upload-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: background-color 0.2s;
            align-self: flex-start;
        }

        .file-upload-btn:hover {
            background-color: rgba(0,0,0,0.05);
        }

        .file-input {
            display: none;
        }

        .chat-input {
            flex: 1;
            border: none;
            background: none;
            outline: none;
            font-size: 16px;
            padding: 0;
            min-height: 72px;
            max-height: 120px;
            resize: none;
        }

        .send-button {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #007AFF;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: background-color 0.2s;
        }

        .send-button:hover {
            background-color: #0056b3;
        }

        .send-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* File Preview */
        .file-preview {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background-color: rgba(0,0,0,0.05);
            border-radius: 8px;
            margin: 8px 0 0 0;
            font-size: 14px;
        }

        .file-remove {
            cursor: pointer;
            color: #666;
            margin-left: 8px;
        }

        /* User Profile Section */
        .user-profile-section {
            background-color: #f8f8f8;
            border-top: 1px solid #e0e0e0;
            margin-top: auto;
        }

        .user-profile {
            display: flex;
            align-items: center;
            padding: 16px;
            gap: 12px;
            cursor: pointer;
            position: relative;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #007AFF;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            font-size: 14px;
        }

        .user-email {
            font-size: 12px;
            color: #666;
        }

        /* Account Settings Styles - Hidden by default for desktop */
        .account-settings-container {
            display: none;
        }
        
        /* Only show in mobile view */
        .mobile-view .account-settings-container {
            position: fixed;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 390px;
            height: 90%;
            background-color: #f5f5f5;
            z-index: 200;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease-out;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
            overflow: hidden;
        }

        .mobile-view .account-settings-container.active {
            transform: translateX(-50%) translateY(-100%);
        }
        
        /* Backdrop for Account Settings - Hidden by default */
        .account-settings-backdrop {
            display: none;
        }
        
        /* Only show backdrop in mobile view */
        .mobile-view .account-settings-backdrop {
            display: block;
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 390px;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 199;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-out;
        }
        
        .mobile-view .account-settings-backdrop.active {
            opacity: 1;
            pointer-events: auto;
        }

        .settings-header {
            background-color: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 60px;
            border-radius: 20px 20px 0 0;
            position: relative;
        }
        
        /* Drag handle indicator */
        .settings-header::before {
            content: '';
            position: absolute;
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 4px;
            background-color: #d0d0d0;
            border-radius: 2px;
        }

        .settings-close-btn {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 32px;
            height: 32px;
            border: none;
            background: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: background-color 0.2s;
            color: #666;
        }

        .settings-close-btn:hover {
            background-color: rgba(0,0,0,0.05);
        }
        
        .settings-back-btn {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 32px;
            height: 32px;
            border: none;
            background: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: background-color 0.2s;
            color: #666;
        }

        .settings-back-btn:hover {
            background-color: rgba(0,0,0,0.05);
        }

        .settings-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .settings-content {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 100px; /* Space for fixed logout button */
        }

        .settings-section {
            background-color: white;
            margin-bottom: 24px;
            border-top: 1px solid #e0e0e0;
            border-bottom: 1px solid #e0e0e0;
        }

        .settings-section-title {
            padding: 12px 20px 8px;
            font-size: 13px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            background-color: #f5f5f5;
        }

        .settings-item {
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #f0f0f0;
            min-height: 56px;
            cursor: pointer;
            transition: background-color 0.2s;
            gap: 16px;
        }
        
        .settings-item-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            flex-shrink: 0;
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item.tappable:hover {
            background-color: rgba(0,0,0,0.02);
        }

        .settings-item.tappable:active {
            background-color: rgba(0,0,0,0.05);
        }

        .settings-item-left {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .settings-item-label {
            font-size: 16px;
            color: #333;
            font-weight: 400;
        }

        .settings-item-value {
            font-size: 14px;
            color: #666;
        }

        .settings-item-arrow {
            color: #999;
            font-size: 18px;
        }
        
        .connect-button {
            padding: 8px 16px;
            background-color: #007AFF;
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .connect-button:hover {
            background-color: #0056b3;
        }

        /* Fixed Logout Button */
        .settings-logout-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            border-top: 1px solid #e0e0e0;
            padding: 16px 20px;
        }

        .logout-button {
            width: 100%;
            padding: 16px;
            background-color: #ff3b30;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logout-button:hover {
            background-color: #ff2d20;
        }

        .logout-button:active {
            background-color: #e02920;
        }




        /* Detail Views (Username, Language) - Hidden by default */
        .settings-detail-view {
            display: none;
        }
        
        /* Only show detail views in mobile */
        .mobile-view .settings-detail-view {
            position: fixed;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 390px;
            height: 90%;
            background-color: #f5f5f5;
            z-index: 202;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease-out;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
            overflow: hidden;
        }

        .mobile-view .settings-detail-view.active {
            transform: translateX(-50%) translateY(-100%);
        }

        .detail-view-header {
            background-color: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 60px;
            border-radius: 20px 20px 0 0;
            position: relative;
        }
        
        /* Drag handle indicator for detail views */
        .detail-view-header::before {
            content: '';
            position: absolute;
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 4px;
            background-color: #d0d0d0;
            border-radius: 2px;
        }

        .detail-view-content {
            flex: 1;
            overflow-y: auto;
            position: relative;
        }
        
        /* Add padding to username edit content to prevent overlap with fixed buttons */
        #usernameEditView .detail-view-content {
            padding-bottom: 140px;
        }

        /* Username Edit View */
        .username-input-container {
            background-color: white;
            margin: 24px 0;
            border-top: 1px solid #e0e0e0;
            border-bottom: 1px solid #e0e0e0;
            padding: 16px 20px;
        }

        .username-input {
            width: 100%;
            padding: 12px 16px;
            font-size: 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #f8f8f8;
        }

        .username-edit-buttons {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            border-top: 1px solid #e0e0e0;
            padding: 16px 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .save-button {
            width: 100%;
            padding: 16px;
            background-color: #8e8e93;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .save-button:hover {
            background-color: #7a7a80;
        }

        .delete-account-button {
            width: 100%;
            padding: 16px;
            background-color: transparent;
            color: #ff3b30;
            border: 2px solid #ff3b30;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .delete-account-button:hover {
            background-color: #ff3b30;
            color: white;
        }

        /* Language Selector View */
        .language-option {
            padding: 16px 20px;
            background-color: white;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color 0.2s;
        }

        .language-option:hover {
            background-color: rgba(0,0,0,0.02);
        }

        .language-option.selected {
            background-color: #007AFF;
            color: white;
        }

        .language-option.selected .language-native {
            color: rgba(255,255,255,0.8);
        }

        .language-name {
            font-size: 16px;
        }

        .language-native {
            font-size: 14px;
            color: #666;
            margin-top: 2px;
        }

        .checkmark {
            font-size: 20px;
            color: white;
        }


        /* View Toggle Button */
        .view-toggle {
            position: fixed;
            right: 20px;
            top: 125px; /* Moved below back to main button */
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            padding: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        /* Hide view toggle on mobile devices */
        @media (max-width: 768px) {
            .view-toggle {
                display: none !important;
            }
            
            body {
                /* Force mobile view on actual mobile devices */
                --is-mobile-device: true;
            }
        }

        .toggle-option {
            width: 36px;
            height: 36px;
            border: none;
            background-color: transparent;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .toggle-option.active {
            background-color: #007AFF;
            color: white;
        }

        .toggle-option:hover:not(.active) {
            background-color: #f0f0f0;
        }

        /* Device Dropdown */
        .device-dropdown {
            position: absolute;
            right: 0;
            top: calc(100% + 4px);
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            min-width: 180px;
            display: none;
            z-index: 1001;
        }

        .device-dropdown.active {
            display: block;
        }

        .device-option {
            padding: 12px 16px;
            cursor: pointer;
            transition: background-color 0.2s;
            border-bottom: 1px solid #f0f0f0;
        }

        .device-option:first-child {
            border-radius: 8px 8px 0 0;
        }

        .device-option:last-child {
            border-bottom: none;
            border-radius: 0 0 8px 8px;
        }

        .device-option:hover {
            background-color: #f5f5f5;
        }

        .device-option.selected {
            background-color: #007AFF;
            color: white;
        }

        .device-name {
            font-weight: 500;
            font-size: 14px;
        }

        .device-size {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
        }

        .device-option.selected .device-size {
            color: rgba(255,255,255,0.8);
        }

        /* Mobile View Styles */
        .mobile-view {
            max-width: 390px;
            margin: 0 auto;
            border: 1px solid #ccc;
            border-radius: 0;
            overflow: hidden;
            position: relative;
            transition: max-width 0.3s ease;
        }

        .mobile-view .app-container {
            border-radius: 0;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .side-nav.active {
                width: 85vw;
            }
            
            .side-nav.active ~ .chat-container .input-container {
                left: calc(50% + 42.5vw);
            }
            
            .input-container {
                width: 95%;
                max-width: none;
            }
        }

        /* Mobile View Input Background */
        .mobile-view .input-background {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 140px;
            background-color: #f5f5f5;
            z-index: 40;
        }

        /* Mobile View Specific Responsive */
        .mobile-view .input-container {
            position: absolute !important;
            bottom: 60px !important;
            left: 20px !important;
            right: 20px !important;
            width: auto !important;
            max-width: none !important;
            margin: 0 !important;
            transform: none !important;
            padding: 0 !important;
            z-index: 50 !important;
        }

        .mobile-view .side-nav.active ~ .chat-container .input-container {
            display: none !important;
        }

        .mobile-view .side-nav.active ~ .chat-container .input-background {
            display: none !important;
        }

        .mobile-view .side-nav.active ~ .chat-container .messages-area {
            display: none !important;
        }

        /* Keep chat header visible when nav is expanded, extend left and position burger menu */
        .mobile-view .side-nav.active ~ .chat-container .chat-header {
            display: flex !important;
            position: absolute;
            top: 0; /* Move header back up */
            left: -60px; /* Extend header left by 60px */
            right: 0;
            height: 60px;
            background-color: transparent;
            z-index: 150;
            justify-content: flex-start;
            align-items: center;
            padding-left: 80px; /* 60px extension + 20px padding */
        }

        /* Hide other header elements when nav is expanded */
        .mobile-view .side-nav.active ~ .chat-container .chat-header .nav-toggle {
            display: none;
        }
        
        .mobile-view .side-nav.active ~ .chat-container .chat-header .chat-header-actions {
            display: none !important;
        }

        /* Position mobile burger menu within mobile viewport when nav is expanded */
        .mobile-view .side-nav.active ~ .chat-container .chat-header .mobile-burger-menu {
            display: flex !important;
            position: static;
            background-color: transparent;
            border-radius: 0;
            box-shadow: none;
            backdrop-filter: none;
            transition: all 0.3s ease;
        }

        /* Mobile-specific burger menu */
        .mobile-burger-menu {
            display: none;
            width: 32px;
            height: 32px;
            cursor: pointer;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 4px;
        }

        .mobile-burger-menu .burger-line {
            width: 18px;
            height: 2px;
            background-color: #333;
            border-radius: 1px;
            transition: all 0.3s ease;
        }

        /* Hide desktop nav-toggle in mobile view */
        .mobile-view .nav-toggle {
            display: none;
        }

        /* Mobile chat header layout with burger menu on left, actions on right */
        .mobile-view .chat-header {
            justify-content: space-between;
            padding: 0 20px;
        }

        .mobile-view .has-messages .chat-header-actions {
            display: flex !important;
        }

        /* Show mobile burger menu in header on mobile */
        .mobile-view .chat-header .mobile-burger-menu {
            position: static;
            display: flex;
            background-color: transparent;
            box-shadow: none;
            backdrop-filter: none;
            border-radius: 0;
            width: 32px;
            height: 32px;
            transform: translateY(5px);
        }

        /* Main Page Styles */
        .main-page {
            min-height: 100vh;
            background: linear-gradient(135deg, #EC6A4A 0%, #d4532a 100%);
            position: relative;
            overflow-x: hidden;
            overflow-y: auto;
        }

        .main-page::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255,255,255,0.08) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(255,255,255,0.05) 0%, transparent 50%);
        }

        .main-navigation {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 24px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: transparent;
        }

        .main-navigation::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .main-navigation.scrolled::after {
            opacity: 1;
        }

        .main-logo {
            height: 40px;
            width: auto;
        }

        .main-nav-links {
            display: flex;
            gap: 32px;
            align-items: center;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            font-weight: 500;
            font-size: 16px;
            transition: opacity 0.2s;
        }

        .nav-link:hover {
            opacity: 0.8;
        }

        .admin-access-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .admin-access-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        .prototype-access {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-right: 20px;
        }

        .prototype-label {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .finger-emoji {
            font-size: 16px;
            margin-left: 2px;
        }

        .prototype-buttons {
            display: flex;
            gap: 8px;
        }

        .prototype-btn {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.25);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .prototype-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-1px);
        }

        .prototype-btn svg {
            opacity: 0.8;
        }

        .main-content {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 140px 40px 40px;
            position: relative;
            z-index: 10;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 120px;
        }

        .caesar-logo {
            width: 160px;
            height: auto;
            margin-bottom: 48px;
            filter: brightness(0) invert(1);
        }

        .hero-title {
            font-size: 64px;
            font-weight: 800;
            margin-bottom: 24px;
            color: white;
            text-shadow: 0 4px 8px rgba(0,0,0,0.2);
            line-height: 1.1;
        }

        .hero-subtitle {
            font-size: 24px;
            color: rgba(255,255,255,0.9);
            font-weight: 400;
            margin-bottom: 48px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.4;
        }

        .sections-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
        }

        .section {
            text-align: center;
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            color: white;
            margin-bottom: 16px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .section-subtitle {
            font-size: 16px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 32px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.4;
        }

        .prototype-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 32px;
            margin-top: 48px;
        }

        .prototype-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 48px 32px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .prototype-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .prototype-card:hover::before {
            left: 100%;
        }

        .prototype-card:hover {
            transform: translateY(-12px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
            background: rgba(255, 255, 255, 1);
        }

        .prototype-icon {
            width: 88px;
            height: 88px;
            background: linear-gradient(135deg, #EC6A4A, #d4532a);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 32px;
            color: white;
            box-shadow: 0 8px 24px rgba(236, 106, 74, 0.3);
        }

        .prototype-card h3 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 16px;
            color: #2c3e50;
        }

        .prototype-card p {
            font-size: 16px;
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .prototype-status {
            display: inline-block;
            background: linear-gradient(135deg, #EC6A4A, #d4532a);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .admin-prototype-status {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        /* PRD Section Styles */
        .prd-grid {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 32px;
        }

        .prd-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 16px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            min-height: 120px;
        }

        .prd-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            background: rgba(255, 255, 255, 1);
        }

        .prd-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .prd-status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .prd-status.active {
            background: #d4edda;
            color: #155724;
        }

        .prd-status.review {
            background: #fff3cd;
            color: #856404;
        }

        .prd-status.draft {
            background: #f8d7da;
            color: #721c24;
        }

        .prd-date {
            font-size: 12px;
            color: #6c757d;
        }

        .prd-card h3 {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 12px;
        }

        .prd-card p {
            font-size: 14px;
            color: #64748b;
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .prd-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
            padding-top: 16px;
            border-top: 1px solid #e9ecef;
        }

        .prd-team {
            font-size: 12px;
            color: #6c757d;
            font-weight: 500;
        }

        .prd-priority {
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .prd-priority.high {
            background: #ffebee;
            color: #c62828;
        }

        .prd-priority.medium {
            background: #fff8e1;
            color: #f57c00;
        }

        .prd-priority.low {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .prd-link {
            font-size: 12px;
            color: #EC6A4A;
            font-weight: 500;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Coming Soon Section Styles */
        .coming-soon-section {
            text-align: center;
            margin-top: 80px;
            padding-top: 60px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .coming-soon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 32px;
        }

        .coming-soon-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .coming-soon-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .coming-soon-card:hover::before {
            opacity: 1;
        }

        .coming-soon-icon {
            width: 64px;
            height: 64px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
        }

        .coming-soon-card h3 {
            font-size: 18px;
            font-weight: 600;
            color: white;
            margin-bottom: 12px;
        }

        .coming-soon-card p {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .coming-soon-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Version Info */
        .version-info {
            position: absolute;
            bottom: 20px;
            right: 40px;
        }

        .version-text {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        /* Design System Styles */
        .design-system-grid {
            display: flex;
            gap: 16px;
            margin-top: 32px;
        }

        .design-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 20px 16px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 140px;
            flex: 1;
        }

        .design-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            background: rgba(255, 255, 255, 1);
        }

        .design-icon {
            width: 64px;
            height: 64px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
        }

        .design-icon.figma {
            background: linear-gradient(135deg, #f24e1e, #ff7262);
        }

        .design-icon.components {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        .design-icon.patterns {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
        }

        .design-icon.resources {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
        }

        .design-card h3 {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 12px;
        }

        .design-card p {
            font-size: 14px;
            color: #64748b;
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .design-meta {
            font-size: 12px;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Coming Soon Prototype Card */
        .prototype-card.coming-soon {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .prototype-card.coming-soon:hover {
            transform: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .back-to-main {
            position: fixed;
            top: 65px;
            right: 20px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            padding: 8px;
            cursor: pointer;
            display: flex; /* Visible by default */
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #333;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 1001;
            transition: all 0.3s ease;
            width: 52px; /* Match toggle width */
            overflow: hidden;
        }

        .back-to-main:hover {
            width: auto;
            padding: 8px 16px 8px 8px;
        }

        .back-icon {
            width: 36px;
            height: 36px;
            border-radius: 12px;
            background-color: #007AFF;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: background-color 0.2s;
        }

        .back-to-main .back-text {
            white-space: nowrap;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .back-to-main:hover .back-text {
            opacity: 1;
            transform: translateX(0);
        }

        .prototype-container {
            position: relative;
        }

        /* Admin Settings Styles */
        .admin-settings-container {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
        }

        .admin-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 60px;
            color: white;
        }

        .admin-header h1 {
            font-size: 48px;
            font-weight: 700;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .admin-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
        }

        .admin-placeholder {
            text-align: center;
            color: white;
            max-width: 500px;
        }

        .admin-placeholder-icon {
            margin-bottom: 32px;
            opacity: 0.8;
        }

        .admin-placeholder h2 {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 16px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .admin-placeholder p {
            font-size: 18px;
            opacity: 0.9;
            line-height: 1.6;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .main-navigation {
                padding: 20px;
                flex-direction: column;
                gap: 16px;
            }
            
            .main-logo {
                height: 32px;
            }
            
            .main-nav-links {
                justify-content: center;
            }
            
            .prototype-access {
                gap: 8px;
                margin-right: 12px;
            }
            
            .prototype-label {
                font-size: 10px;
                gap: 4px;
            }
            
            .finger-emoji {
                font-size: 14px;
            }
            
            .prototype-buttons {
                gap: 6px;
            }
            
            .prototype-btn {
                padding: 6px 10px;
                font-size: 11px;
            }
            
            .admin-access-btn {
                padding: 8px 16px;
                font-size: 12px;
            }
            
            .main-content {
                padding: 40px 20px;
            }
            
            .coming-soon-section {
                margin-top: 60px;
                padding-top: 40px;
            }
            
            .coming-soon-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .coming-soon-card {
                padding: 20px 16px;
            }
            
            .version-info {
                right: 20px;
                bottom: 15px;
            }
            
            .section-title {
                font-size: 36px;
            }
            
            .section-subtitle {
                font-size: 18px;
            }
            
            .sections-container {
                grid-template-columns: 1fr;
                gap: 40px;
            }
            
            .design-system-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .admin-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
            }
            
            .admin-header h1 {
                font-size: 36px;
            }
            
            .admin-placeholder h2 {
                font-size: 28px;
            }
            
            .admin-placeholder p {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- View Toggle Button -->
    <div class="view-toggle">
        <button class="toggle-option active" id="desktopToggle" onclick="switchView('desktop')" title="Desktop View">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                <line x1="8" y1="21" x2="16" y2="21"></line>
                <line x1="12" y1="17" x2="12" y2="21"></line>
            </svg>
        </button>
        <div style="position: relative;">
            <button class="toggle-option" id="mobileToggle" onclick="toggleMobileView()" title="Mobile View">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
                    <line x1="12" y1="18" x2="12.01" y2="18"></line>
                </svg>
            </button>
            
            <div class="device-dropdown" id="deviceDropdown">
                <div class="device-option selected" onclick="selectDevice('iphone14', 390)">
                    <div class="device-name">iPhone 14</div>
                    <div class="device-size">390 × 844px</div>
                </div>
                <div class="device-option" onclick="selectDevice('pixel7', 412)">
                    <div class="device-name">Pixel 7</div>
                    <div class="device-size">412 × 915px</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Page -->
    <div class="main-page" id="mainPage">
        <!-- Navigation Bar -->
        <nav class="main-navigation">
            <img src="/Users/jackhughes/Downloads/System 4/Variant=Light.png" alt="Caesar Logo" class="main-logo">
            <div class="main-nav-links">
                <div class="prototype-access">
                    <div class="prototype-label">
                        Try Prototypes
                        <span class="finger-emoji">👉</span>
                    </div>
                    <div class="prototype-buttons">
                        <button class="prototype-btn mobile" onclick="openPrototype('mobile')">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
                                <line x1="12" y1="18" x2="12.01" y2="18"></line>
                            </svg>
                            Mobile
                        </button>
                        <button class="prototype-btn desktop" onclick="openPrototype('desktop')">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                <line x1="8" y1="21" x2="16" y2="21"></line>
                                <line x1="12" y1="17" x2="12" y2="21"></line>
                            </svg>
                            Desktop
                        </button>
                    </div>
                </div>
                <button class="admin-access-btn" onclick="openAdminSettings()">Admin Access</button>
            </div>
        </nav>

        <div class="main-content">
            <!-- Current PRDs Section -->
            <div class="sections-container">
                <div class="section prds">
                    <h2 class="section-title">Current PRDs</h2>
                    <p class="section-subtitle">Product Requirements Documents for active development projects</p>
                    
                    <div class="prd-grid">
                        <div class="prd-card" onclick="window.open('https://caesar.atlassian.net/jira/core/projects/CD/board?groupBy=status&selectedIssue=CD-6', '_blank')" style="cursor: pointer;">
                            <div class="prd-header">
                                <div class="prd-status active">Active</div>
                                <div class="prd-date">Updated 1 day ago</div>
                            </div>
                            <h3>Settings Update for Mobile and Desktop</h3>
                            <p>Comprehensive settings interface improvements for both mobile and desktop platforms including enhanced user experience and accessibility features.</p>
                            <div class="prd-meta">
                                <span class="prd-team">Design Team</span>
                                <span class="prd-priority high">High Priority</span>
                                <span class="prd-link">📋 Design Jira Board</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Design System Section -->
                <div class="section design">
                    <h2 class="section-title">Design System</h2>
                    <p class="section-subtitle">Comprehensive design language and component library</p>
                    
                    <div class="design-system-grid">
                        <div class="design-card" data-category="figma" onclick="window.open('https://www.figma.com/design/sCiFU3N8skqZJ5SEvQbhM4/Caesar-Design-System?node-id=951-150&p=f&m=dev', '_blank')" style="cursor: pointer;">
                            <div class="design-icon figma">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M5 5.5A3.5 3.5 0 0 1 8.5 2H12v7H8.5A3.5 3.5 0 0 1 5 5.5z"></path>
                                    <path d="M12 2h3.5a3.5 3.5 0 1 1 0 7H12V2z"></path>
                                    <path d="M12 12.5a3.5 3.5 0 1 1 7 0 3.5 3.5 0 1 1-7 0z"></path>
                                    <path d="M5 19.5A3.5 3.5 0 0 1 8.5 16H12v3.5a3.5 3.5 0 1 1-7 0z"></path>
                                    <path d="M5 12.5A3.5 3.5 0 0 1 8.5 9H12v7H8.5A3.5 3.5 0 0 1 5 12.5z"></path>
                                </svg>
                            </div>
                            <h3>Figma<br>Design System</h3>
                            <p>Complete design system files and component library</p>
                            <div class="design-meta">🎨 Open in Figma</div>
                        </div>
                        
                        <div class="design-card" data-category="components" onclick="window.open('https://caesar-app-storybook.vercel.app/?path=/settings/about', '_blank')" style="cursor: pointer;">
                            <div class="design-icon components">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                    <line x1="8" y1="21" x2="16" y2="21"></line>
                                    <line x1="12" y1="17" x2="12" y2="21"></line>
                                </svg>
                            </div>
                            <h3>Storybook Components</h3>
                            <p>Interactive component library and documentation</p>
                            <div class="design-meta">📚 View Storybook</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Coming Soon Section -->
            <div class="coming-soon-section">
                <h2 class="section-title">Coming Soon</h2>
                <p class="section-subtitle">Additional resources and tools currently in development</p>
                
                <div class="coming-soon-grid">
                    <div class="coming-soon-card">
                        <div class="coming-soon-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <line x1="16" y1="21" x2="8" y2="21"></line>
                            </svg>
                        </div>
                        <h3>Product Definitions</h3>
                        <p>Comprehensive product specification and feature definitions</p>
                        <div class="coming-soon-badge">Coming Soon</div>
                    </div>
                    
                    <div class="coming-soon-card">
                        <div class="coming-soon-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                <line x1="8" y1="21" x2="16" y2="21"></line>
                                <line x1="12" y1="17" x2="12" y2="21"></line>
                                <circle cx="12" cy="10" r="3"></circle>
                            </svg>
                        </div>
                        <h3>App Preview</h3>
                        <p>Interactive preview of upcoming application features and interfaces</p>
                        <div class="coming-soon-badge">Coming Soon</div>
                    </div>
                    
                    <div class="coming-soon-card">
                        <div class="coming-soon-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 19.5A2.5 2.5 0 0 0 6.5 22H20a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H6.5A2.5 2.5 0 0 0 4 4.5"></path>
                                <polyline points="16 2 16 6 20 6"></polyline>
                                <line x1="10" y1="11" x2="8" y2="11"></line>
                                <line x1="10" y1="15" x2="8" y2="15"></line>
                                <line x1="14" y1="11" x2="12" y2="11"></line>
                            </svg>
                        </div>
                        <h3>Product Documentation</h3>
                        <p>Complete user guides, API references, and technical documentation</p>
                        <div class="coming-soon-badge">Coming Soon</div>
                    </div>
                </div>
            </div>
            
            <!-- Version Info -->
            <div class="version-info">
                <span class="version-text">v1.0.0</span>
            </div>
        </div>
    </div>

    <!-- Admin Settings Container -->
    <div class="admin-settings-container" id="adminSettingsContainer" style="display: none;">
        <div class="admin-header">
            <button class="back-to-main" onclick="backToMainFromAdmin()">
                <div class="back-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m12 19-7-7 7-7"></path>
                        <path d="m19 12-7 7-7-7"></path>
                    </svg>
                </div>
                <span class="back-text">Back to Main</span>
            </button>
            <h1>Admin Settings</h1>
        </div>
        
        <div class="admin-content">
            <div class="admin-placeholder">
                <div class="admin-placeholder-icon">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1m17-4a4 4 0 0 1-8 0 4 4 0 0 1 8 0zM7 12a4 4 0 0 1-8 0 4 4 0 0 1 8 0z"></path>
                    </svg>
                </div>
                <h2>Admin Configuration</h2>
                <p>This is where administrative settings and configuration options will be built out.</p>
            </div>
        </div>
    </div>

    <!-- Prototype Container -->
    <div class="prototype-container mobile-wrapper" id="prototypeContainer" style="display: none;">
        <button class="back-to-main" onclick="backToMain()">
            <div class="back-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m12 19-7-7 7-7"></path>
                    <path d="m19 12-7 7-7-7"></path>
                </svg>
            </div>
            <span class="back-text">Back to Main</span>
        </button>
        
    <div class="app-container" id="appContainer">
        <!-- Side Navigation -->
        <nav class="side-nav active" id="sideNav">
            <div class="nav-header">
                <div style="display: flex; align-items: center; gap: 12px; flex: 1;">
                    <div style="width: 40px; height: 40px; background-color: #007AFF; border-radius: 8px;"></div>
                    <div style="padding: 4px 12px; background-color: rgba(255,255,255,0.2); border: 1px solid rgba(0,0,0,0.1); border-radius: 20px; font-size: 12px; color: #666;">Alpha</div>
                </div>
                <button onclick="newChat()" style="width: 36px; height: 36px; border-radius: 8px; background-color: #f0f0f0; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#e0e0e0'" onmouseout="this.style.backgroundColor='#f0f0f0'">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="m18.5 2.5 a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                </button>
            </div>
            
            <div class="nav-content">
                <div style="margin-top: 24px;"></div>
                <div class="nav-section-title">ASKS</div>
            <div class="nav-item" onclick="loadChat('Morning conversation')">Quantum Computing Cryptographic Implications</div>
            <div class="nav-item" onclick="loadChat('Project discussion')">Modern Web Framework Analysis</div>
            <div class="nav-item" onclick="loadChat('Code review')">Authentication Security Best Practices</div>
            <div class="nav-item" onclick="loadChat('Design ideas')">AI E-commerce Personalization Strategies</div>
            <div class="nav-item" onclick="loadChat('API documentation')">Scalable RESTful API Design</div>
            <div class="nav-item" onclick="loadChat('Database schema')">Multi-Tenant Database Architecture</div>
            </div>
            
            <!-- Documentation Cards -->
            <div style="padding: 16px 20px;">
                <div class="doc-card" onclick="openDocs('getting-started')">
                    <div class="doc-card-title">Getting started with Asks</div>
                    <div class="doc-card-subtitle">Learn how to make the most of Caesar.</div>
                </div>
                <div class="doc-card" onclick="openDocs('api')" style="margin-top: 12px;">
                    <div class="doc-card-title">Caesar API</div>
                    <div class="doc-card-subtitle">Access the API docs</div>
                </div>
            </div>
            
            <!-- User Profile Section -->
            <div class="user-profile-section">
                <div class="user-profile">
                    <div class="user-avatar">JH</div>
                    <div class="user-info">
                        <div class="user-name">John Hughes</div>
                        <div class="user-email">john@example.com</div>
                    </div>
                    <button onclick="openAccountSettings()" style="width: 32px; height: 32px; border-radius: 8px; background-color: transparent; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='rgba(0,0,0,0.1)'" onmouseout="this.style.backgroundColor='transparent'">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="5" cy="12" r="1"></circle>
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="19" cy="12" r="1"></circle>
                        </svg>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Chat Container -->
        <div class="chat-container">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="nav-toggle" onclick="toggleSideNav()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="9" y1="3" x2="9" y2="21"></line>
                    </svg>
                </div>
                
                <!-- Mobile Burger Menu -->
                <div class="mobile-burger-menu" onclick="toggleSideNav()">
                    <div class="burger-line"></div>
                    <div class="burger-line"></div>
                </div>
                
                <div class="chat-header-actions">
                    <button class="header-icon" onclick="shareChat()" title="Share">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                            <polyline points="16,6 12,2 8,6"></polyline>
                            <line x1="12" y1="2" x2="12" y2="15"></line>
                        </svg>
                    </button>
                    <button class="header-icon" onclick="openChatMenu()" title="Menu">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="12" cy="5" r="1"></circle>
                            <circle cx="12" cy="19" r="1"></circle>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div class="messages-area" id="messagesArea">
            </div>

            <!-- Mobile Input Background -->
            <div class="input-background"></div>

            <!-- Input Container -->
            <div class="input-container">
                <div class="input-wrapper">
                    <div class="input-box">
                        <textarea 
                            class="chat-input" 
                            id="chatInput" 
                            placeholder="Ask anything"
                            rows="3"
                            onkeydown="handleKeyPress(event)"
                            oninput="autoResize(this)"
                        ></textarea>
                        <div id="filePreview"></div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <button class="file-upload-btn" onclick="document.getElementById('fileInput').click()">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                                </svg>
                            </button>
                            <button class="send-button" id="sendButton" onclick="sendMessage()">
                                ➤
                            </button>
                        </div>
                        <input type="file" id="fileInput" class="file-input" multiple onchange="handleFileSelect(event)">
                    </div>
                </div>
                <div style="text-align: center; margin-top: 12px; font-size: 12px; color: #999;">
                    Caesar can make mistakes. Please double-check responses.
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedFiles = [];

        function toggleSideNav() {
            const sideNav = document.getElementById('sideNav');
            sideNav.classList.toggle('active');
        }

        // Auto-focus input on load
        window.addEventListener('load', function() {
            document.getElementById('chatInput').focus();
        });

        function loadChat(chatName) {
            const messagesArea = document.getElementById('messagesArea');
            const chatContainer = document.querySelector('.chat-container');
            const appContainer = document.getElementById('appContainer');
            
            // Check if we're in mobile view mode
            const isMobileView = appContainer.parentElement.classList.contains('mobile-view');
            
            // Close navigation in mobile view
            if (isMobileView) {
                toggleSideNav();
            }
            
            // Add has-messages class to move input to bottom
            chatContainer.classList.add('has-messages');
            
            // Sample conversation for the selected chat with Caesar's deep research format
            const sampleResponses = {
                'Morning conversation': {
                    question: 'What are the latest developments in quantum computing and how will they impact cryptography?',
                    response: `
                        <div class="research-container">
                            <div class="research-content">
                                <div class="research-header">
                                    <h1>Quantum Computing Cryptographic Implications</h1>
                                </div>
                                
                                <div class="research-question">
                                    What are the latest developments in quantum computing and how will they impact cryptography?
                                </div>
                                
                                <div class="research-answer">
                                    <h2 id="recent-quantum-computing-milestones">Recent Quantum Computing Milestones</h2>
                                    <p>The quantum computing landscape has experienced remarkable progress in 2024, with several groundbreaking achievements that bring us closer to practical quantum advantage.</p>
                                    
                                    <h3>IBM's 1000+ Qubit Systems</h3>
                                    <p>IBM announced its Condor processor with 1,121 superconducting qubits, marking a significant milestone in scaling quantum systems. The processor demonstrates improved error rates through advanced error mitigation techniques, achieving coherence times exceeding 200 microseconds.</p>
                                    
                                    <h3>Google's Error Correction Breakthrough</h3>
                                    <p>Google's Quantum AI team achieved a major breakthrough in quantum error correction using their surface code implementation. They demonstrated that increasing the size of their logical qubits from 17 to 49 physical qubits reduced the error rate by a factor of 2.14, proving that quantum error correction can work in practice.</p>
                                    
                                    <h2 id="impact-on-current-cryptographic-systems">Impact on Current Cryptographic Systems</h2>
                                    <p>The advancement of quantum computing poses an existential threat to many cryptographic protocols currently securing global communications and data.</p>
                                    
                                    <h3>RSA and Elliptic Curve Vulnerability</h3>
                                    <p>Shor's algorithm, when run on a sufficiently powerful quantum computer, can factor large integers and compute discrete logarithms in polynomial time. Current estimates suggest that breaking RSA-2048 would require approximately 20 million noisy qubits or 4,000 error-corrected logical qubits. With current progress, this threshold could be reached within 10-15 years.</p>
                                    
                                    <h3>Timeline for Cryptographic Threats</h3>
                                    <p>The "Y2Q" moment - when quantum computers can break current encryption - is estimated by experts to occur between 2030 and 2040. However, "harvest now, decrypt later" attacks mean that sensitive data encrypted today could be vulnerable when quantum computers become available.</p>
                                    
                                    <h2 id="post-quantum-cryptography-solutions">Post-Quantum Cryptography Solutions</h2>
                                    <p>In response to quantum threats, the cryptographic community has developed new algorithms resistant to quantum attacks.</p>
                                    
                                    <h3>NIST Standardization</h3>
                                    <p>The National Institute of Standards and Technology (NIST) finalized its first set of post-quantum cryptographic standards in 2024, including CRYSTALS-Kyber for key encapsulation and CRYSTALS-Dilithium for digital signatures. These algorithms are based on mathematical problems believed to be difficult even for quantum computers.</p>
                                    
                                    <h3>Implementation Challenges</h3>
                                    <p>Post-quantum algorithms typically require larger key sizes and more computational resources. For example, CRYSTALS-Kyber public keys are 800-1,568 bytes compared to 256-bit ECC keys at 64 bytes. This presents challenges for resource-constrained devices and requires careful optimization.</p>
                                </div>
                            </div>
                            
                            <div class="section-nav">
                                <div class="section-nav-title">On this page</div>
                                <div class="section-nav-item active" onclick="scrollToSection('recent-quantum-computing-milestones')">Recent Quantum Computing Milestones</div>
                                <div class="section-nav-item" onclick="scrollToSection('impact-on-current-cryptographic-systems')">Impact on Current Cryptographic Systems</div>
                                <div class="section-nav-item" onclick="scrollToSection('post-quantum-cryptography-solutions')">Post-Quantum Cryptography Solutions</div>
                            </div>
                        </div>
                    `
                },
                'Project discussion': {
                    question: 'How do modern web frameworks compare for building scalable SaaS applications?',
                    response: `
                        <div class="research-container">
                            <div class="research-content">
                                <div class="research-header">
                                    <h1>Modern Web Framework Analysis</h1>
                                </div>
                                
                                <div class="research-question">
                                    How do modern web frameworks compare for building scalable SaaS applications?
                                </div>
                                
                                <div class="research-answer">
                                    <h2 id="framework-performance-benchmarks">Framework Performance Benchmarks</h2>
                                    <p>Recent benchmarks from TechEmpower and real-world SaaS deployments provide insights into framework performance at scale.</p>
                                    
                                    <h3>Request Handling Performance</h3>
                                    <p>Next.js 14 with App Router demonstrates exceptional performance, handling 45,000 requests per second in production environments with server components. Remix achieves similar throughput at 42,000 RPS with its nested routing architecture. Traditional SPAs using React or Vue typically max out around 25,000 RPS due to client-side rendering overhead.</p>
                                    
                                    <h3>Time to First Byte (TTFB)</h3>
                                    <p>Server-side rendering frameworks show significant advantages: Next.js averages 50-100ms TTFB, while Nuxt 3 achieves 60-120ms. Client-side frameworks require 200-400ms for initial bundle download plus rendering time. Edge runtime deployments can reduce TTFB to under 30ms globally.</p>
                                    
                                    <h2 id="developer-experience-and-productivity">Developer Experience and Productivity</h2>
                                    <p>Framework choice significantly impacts development velocity and team satisfaction in SaaS environments.</p>
                                    
                                    <h3>Type Safety and Developer Tools</h3>
                                    <p>TypeScript-first frameworks like Next.js, Remix, and SvelteKit provide end-to-end type safety. T3 Stack (TypeScript, tRPC, Tailwind) has gained adoption for its exceptional DX, with teams reporting 40% faster feature development. Prisma integration provides type-safe database access, eliminating runtime errors.</p>
                                    
                                    <h3>Learning Curve Analysis</h3>
                                    <p>Vue.js maintains the gentlest learning curve with its template-based approach. React requires understanding hooks and state management patterns. Svelte's compiler-based approach is intuitive but requires adjusting to its reactive declarations. Angular's steep learning curve is offset by its comprehensive tooling for enterprise teams.</p>
                                    
                                    <h2 id="scalability-patterns-and-architecture">Scalability Patterns and Architecture</h2>
                                    <p>Different frameworks excel at different scaling challenges faced by growing SaaS applications.</p>
                                    
                                    <h3>Horizontal Scaling Capabilities</h3>
                                    <p>Stateless frameworks like Next.js and Nuxt scale horizontally with ease on platforms like Vercel or Netlify. Remix's loader pattern naturally distributes data fetching across edge nodes. Traditional SPAs require careful API gateway design but offer more flexibility in backend scaling.</p>
                                    
                                    <h3>Multi-tenant Architecture Support</h3>
                                    <p>Next.js middleware excels at tenant isolation through URL rewriting and header manipulation. Django + React combinations provide mature multi-tenant database patterns. Laravel + Inertia.js offers built-in tenant scoping with minimal configuration.</p>
                                    
                                    <h2 id="cost-analysis-for-saas-operations">Cost Analysis for SaaS Operations</h2>
                                    <p>Infrastructure and operational costs vary significantly between framework choices.</p>
                                    
                                    <h3>Hosting and Infrastructure Costs</h3>
                                    <p>Serverless frameworks reduce costs for variable traffic: Next.js on Vercel scales to zero, costing $0 during idle periods. Traditional deployments on AWS EC2 require minimum $50-200/month. Edge functions cost approximately $0.50 per million requests, making them cost-effective for global SaaS.</p>
                                    
                                    <h3>Development and Maintenance Costs</h3>
                                    <p>Full-stack frameworks reduce team size requirements. Companies report needing 2-3 developers with Next.js versus 4-5 for separate frontend/backend stacks. Automated deployment pipelines in modern frameworks save 10-15 hours per developer monthly.</p>
                                </div>
                            </div>
                            
                            <div class="section-nav">
                                <div class="section-nav-title">On this page</div>
                                <div class="section-nav-item active" onclick="scrollToSection('framework-performance-benchmarks')">Framework Performance Benchmarks</div>
                                <div class="section-nav-item" onclick="scrollToSection('developer-experience-and-productivity')">Developer Experience and Productivity</div>
                                <div class="section-nav-item" onclick="scrollToSection('scalability-patterns-and-architecture')">Scalability Patterns and Architecture</div>
                                <div class="section-nav-item" onclick="scrollToSection('cost-analysis-for-saas-operations')">Cost Analysis for SaaS Operations</div>
                            </div>
                        </div>
                    `
                },
                'Code review': {
                    question: 'What are the best practices for implementing secure authentication in 2024?',
                    response: `
                        <div class="research-container">
                            <div class="research-content">
                                <div class="research-header">
                                    <h1>Authentication Security Best Practices</h1>
                                </div>
                                
                                <div class="research-question">
                                    What are the best practices for implementing secure authentication in 2024?
                                </div>
                                
                                <div class="research-answer">
                                    <h2 id="passwordless-authentication-standards">Passwordless Authentication Standards</h2>
                                    <p>The authentication landscape in 2024 has shifted dramatically toward passwordless methods, driven by security breaches and user experience demands.</p>
                                    
                                    <h3>WebAuthn and Passkeys Implementation</h3>
                                    <p>WebAuthn has become the gold standard for passwordless authentication. Apple, Google, and Microsoft's coordinated passkey support means 95% of users can now authenticate without passwords. Implementation requires FIDO2-compliant servers and careful attention to account recovery flows. Passkeys reduce account takeover incidents by 99.9% compared to password-based systems.</p>
                                    
                                    <h3>Magic Link Security Considerations</h3>
                                    <p>Magic links remain popular for user onboarding but require careful implementation. Links must expire within 15 minutes, be single-use, and include rate limiting. Consider implementing risk-based authentication that requires additional verification for suspicious login patterns. Always use cryptographically secure random tokens of at least 32 bytes.</p>
                                    
                                    <h2 id="multi-factor-authentication-evolution">Multi-Factor Authentication Evolution</h2>
                                    <p>MFA has evolved beyond SMS OTP to more secure and user-friendly methods.</p>
                                    
                                    <h3>Biometric Integration Patterns</h3>
                                    <p>Device-based biometrics through WebAuthn provide seamless MFA. Implement fallback mechanisms for devices without biometric capabilities. Privacy regulations require explicit consent and local biometric processing - never transmit biometric data to servers. Success rates exceed 99.5% with proper implementation.</p>
                                    
                                    <h3>Risk-Based Adaptive Authentication</h3>
                                    <p>Modern systems analyze login context including device fingerprinting, location, time patterns, and behavioral biometrics. Suspicious activities trigger step-up authentication. Machine learning models can reduce false positives to under 0.1% while catching 95% of account takeover attempts.</p>
                                    
                                    <h2 id="session-management-best-practices">Session Management Best Practices</h2>
                                    <p>Secure session handling is critical for maintaining authentication security post-login.</p>
                                    
                                    <h3>Token Rotation and Storage</h3>
                                    <p>Implement refresh token rotation with detection of token reuse. Access tokens should expire within 15 minutes for sensitive applications. Store tokens in httpOnly, secure, sameSite cookies to prevent XSS attacks. For mobile apps, use platform-specific secure storage (iOS Keychain, Android Keystore).</p>
                                    
                                    <h3>Distributed Session Handling</h3>
                                    <p>Microservices architectures require careful session synchronization. JWT tokens with short expiration provide stateless authentication but require careful key management. Consider using Redis with encryption at rest for centralized session storage. Implement session invalidation webhooks for immediate revocation across services.</p>
                                    
                                    <h2 id="compliance-and-privacy-requirements">Compliance and Privacy Requirements</h2>
                                    <p>Regulatory requirements shape authentication implementation in 2024.</p>
                                    
                                    <h3>GDPR and Global Privacy Laws</h3>
                                    <p>Authentication systems must support data portability and deletion. Implement privacy-preserving analytics that don't track individual users. Consent management must be granular and reversible. Consider zero-knowledge proofs for authentication without storing personal data.</p>
                                    
                                    <h3>Industry-Specific Requirements</h3>
                                    <p>Healthcare requires HIPAA-compliant authentication with audit trails. Financial services need PSD2 strong customer authentication (SCA) with dynamic linking. Government systems increasingly require PIV/CAC card integration or derived credentials. Each industry has specific session timeout and re-authentication requirements.</p>
                                </div>
                            </div>
                            
                            <div class="section-nav">
                                <div class="section-nav-title">On this page</div>
                                <div class="section-nav-item active" onclick="scrollToSection('passwordless-authentication-standards')">Passwordless Authentication Standards</div>
                                <div class="section-nav-item" onclick="scrollToSection('multi-factor-authentication-evolution')">Multi-Factor Authentication Evolution</div>
                                <div class="section-nav-item" onclick="scrollToSection('session-management-best-practices')">Session Management Best Practices</div>
                                <div class="section-nav-item" onclick="scrollToSection('compliance-and-privacy-requirements')">Compliance and Privacy Requirements</div>
                            </div>
                        </div>
                    `
                },
                'Design ideas': {
                    question: 'How can AI be used to personalize user experiences in e-commerce?',
                    response: `
                        <div class="research-container">
                            <div class="research-content">
                                <div class="research-header">
                                    <h1>AI E-commerce Personalization Strategies</h1>
                                </div>
                                
                                <div class="research-question">
                                    How can AI be used to personalize user experiences in e-commerce?
                                </div>
                                
                                <div class="research-answer">
                                    <h2 id="recommendation-engine-architectures">Recommendation Engine Architectures</h2>
                                    <p>Modern e-commerce platforms leverage sophisticated AI models to deliver personalized product recommendations that drive significant revenue increases.</p>
                                    
                                    <h3>Collaborative Filtering vs Deep Learning</h3>
                                    <p>While traditional collaborative filtering still works for established catalogs, deep learning models like Two-Tower neural networks outperform by 35% in cold-start scenarios. Amazon's latest recommendation system combines transformer architectures with graph neural networks, processing user behavior sequences and product relationships simultaneously. This hybrid approach increased click-through rates by 24% compared to previous methods.</p>
                                    
                                    <h3>Real-Time Personalization Pipelines</h3>
                                    <p>Streaming architectures using Apache Kafka and Flink enable sub-50ms recommendation updates. Feature stores like Feast or Tecton maintain user profiles with 100+ real-time signals including browsing patterns, cart abandonment, and price sensitivity. GPU-accelerated inference servers handle millions of predictions per second, essential for Black Friday scale.</p>
                                    
                                    <h2 id="dynamic-pricing-and-inventory-optimization">Dynamic Pricing and Inventory Optimization</h2>
                                    <p>AI enables sophisticated pricing strategies that maximize revenue while maintaining customer satisfaction.</p>
                                    
                                    <h3>Personalized Pricing Models</h3>
                                    <p>Reinforcement learning algorithms optimize prices based on individual price elasticity, competitor monitoring, and inventory levels. Walmart's pricing AI adjusts 50 million prices daily, achieving 3-5% margin improvements. Ethical considerations require transparency - showing price history and avoiding discriminatory practices. A/B testing frameworks must account for network effects and cannibalization.</p>
                                    
                                    <h3>Demand Forecasting Integration</h3>
                                    <p>Prophet and LightGBM models predict demand at SKU-location level with 85% accuracy for 30-day horizons. Incorporating external signals like weather, events, and social media trends improves accuracy by 12%. Automated reordering systems prevent stockouts while minimizing carrying costs, particularly crucial for perishable goods.</p>
                                    
                                    <h2 id="conversational-commerce-and-ai-assistants">Conversational Commerce and AI Assistants</h2>
                                    <p>Natural language interfaces are transforming how customers discover and purchase products.</p>
                                    
                                    <h3>Visual Search and Discovery</h3>
                                    <p>Computer vision models using EfficientNet architectures enable "shop the look" features with 92% accuracy. Pinterest's Shop the Look processes 600 million searches monthly. Multi-modal transformers combine text queries with images, understanding requests like "shoes similar to these but in blue." Implementation requires careful image preprocessing and CDN optimization for mobile users.</p>
                                    
                                    <h3>Conversational AI Implementation</h3>
                                    <p>Large language models fine-tuned on product catalogs provide natural shopping assistants. RAG (Retrieval Augmented Generation) architectures ensure accurate product information while maintaining conversational flow. Successful implementations see 40% higher conversion rates compared to traditional search. Key challenges include handling multi-turn conversations and graceful fallbacks to human agents.</p>
                                    
                                    <h2 id="personalization-ethics-and-privacy">Personalization Ethics and Privacy</h2>
                                    <p>Balancing personalization benefits with user privacy remains a critical challenge.</p>
                                    
                                    <h3>Privacy-Preserving Techniques</h3>
                                    <p>Federated learning enables personalization without centralizing user data. Apple's on-device recommendations process 98% of personalization locally. Differential privacy adds mathematical guarantees against individual identification while maintaining model utility. Homomorphic encryption allows computation on encrypted user data, though computational overhead remains challenging at scale.</p>
                                    
                                    <h3>Transparency and User Control</h3>
                                    <p>GDPR and CCPA compliance requires explainable AI for personalization decisions. Shopify's "Why am I seeing this?" feature increased trust scores by 22%. User dashboards should allow preference editing, data deletion, and personalization opt-outs. Consider progressive disclosure of AI involvement to maintain the "magic" while building trust.</p>
                                </div>
                            </div>
                            
                            <div class="section-nav">
                                <div class="section-nav-title">On this page</div>
                                <div class="section-nav-item active" onclick="scrollToSection('recommendation-engine-architectures')">Recommendation Engine Architectures</div>
                                <div class="section-nav-item" onclick="scrollToSection('dynamic-pricing-and-inventory-optimization')">Dynamic Pricing and Inventory</div>
                                <div class="section-nav-item" onclick="scrollToSection('conversational-commerce-and-ai-assistants')">Conversational Commerce</div>
                                <div class="section-nav-item" onclick="scrollToSection('personalization-ethics-and-privacy')">Personalization Ethics</div>
                            </div>
                        </div>
                    `
                },
                'API documentation': {
                    question: 'What are the key principles of designing RESTful APIs that scale?',
                    response: `
                        <div class="research-container">
                            <div class="research-content">
                                <div class="research-header">
                                    <h1>Scalable RESTful API Design</h1>
                                </div>
                                
                                <div class="research-question">
                                    What are the key principles of designing RESTful APIs that scale?
                                </div>
                                
                                <div class="research-answer">
                                    <h2 id="resource-design-and-url-structure">Resource Design and URL Structure</h2>
                                    <p>Well-designed resource models form the foundation of scalable REST APIs, impacting performance and developer experience.</p>
                                    
                                    <h3>Hierarchical Resource Modeling</h3>
                                    <p>Stripe's API demonstrates exemplary resource design with clear parent-child relationships: /v1/customers/{id}/subscriptions. This hierarchy enables efficient caching and authorization. Avoid deep nesting beyond 3 levels - flatten with resource expansion instead. GitHub's API allows ?expand=owner,collaborators to reduce round trips by 70%.</p>
                                    
                                    <h3>Versioning Strategies</h3>
                                    <p>URL versioning (/v1/, /v2/) remains most popular, used by 73% of public APIs. However, content negotiation via Accept headers provides more flexibility. Stripe's approach of maintaining all versions indefinitely with clear deprecation timelines has become the gold standard. Implement version transformation layers to minimize code duplication across versions.</p>
                                    
                                    <h2 id="performance-optimization-techniques">Performance Optimization Techniques</h2>
                                    <p>High-traffic APIs require sophisticated optimization strategies beyond basic caching.</p>
                                    
                                    <h3>Pagination and Data Windowing</h3>
                                    <p>Cursor-based pagination outperforms offset/limit at scale - Discord's API handles billions of messages using snowflake IDs as cursors. Implement consistent pagination with hasMore flags and next tokens. For real-time feeds, consider timestamp-based windowing with long-polling or Server-Sent Events. Response compression with Brotli reduces payload sizes by 25% compared to gzip.</p>
                                    
                                    <h3>Caching Strategies</h3>
                                    <p>Multi-layer caching dramatically improves performance: CDN edge caching for static resources, Redis for hot data, and database query caching. ETags enable conditional requests, reducing bandwidth by 80% for unchanged resources. Cache invalidation via webhooks or event streams maintains consistency. Consider stale-while-revalidate patterns for non-critical data.</p>
                                    
                                    <h2 id="rate-limiting-and-traffic-management">Rate Limiting and Traffic Management</h2>
                                    <p>Protecting API infrastructure while ensuring fair access requires sophisticated rate limiting.</p>
                                    
                                    <h3>Adaptive Rate Limiting</h3>
                                    <p>Token bucket algorithms provide flexible rate limiting - Twitter uses 15-minute windows with burst allowances. Implement graduated limits based on authentication level, with higher limits for paid tiers. Return X-RateLimit headers for client awareness. Consider cost-based limiting where expensive operations consume more quota than simple reads.</p>
                                    
                                    <h3>Circuit Breakers and Graceful Degradation</h3>
                                    <p>Netflix's Hystrix patterns prevent cascade failures - circuit breakers trip after 50% error rate over 20 requests. Implement fallbacks for non-critical features and partial responses for degraded services. Health check endpoints should reflect downstream dependencies. Use exponential backoff with jitter for retry logic to prevent thundering herds.</p>
                                    
                                    <h2 id="security-and-authentication-patterns">Security and Authentication Patterns</h2>
                                    <p>API security requires defense in depth with multiple layers of protection.</p>
                                    
                                    <h3>OAuth 2.0 and JWT Best Practices</h3>
                                    <p>Implement OAuth 2.0 with PKCE for public clients, preventing authorization code interception. JWT tokens should use RS256 signing with key rotation every 90 days. Include minimal claims to reduce token size - store extended permissions in backend caches. Refresh token rotation with breach detection prevents long-term token compromise.</p>
                                    
                                    <h3>API Gateway Security</h3>
                                    <p>Kong, Apigee, or AWS API Gateway provide centralized security enforcement. Implement request signing for sensitive operations - AWS Signature Version 4 prevents replay attacks. Rate limit by API key AND IP address to prevent distributed attacks. GraphQL APIs require query depth limiting and cost analysis to prevent resource exhaustion.</p>
                                </div>
                            </div>
                            
                            <div class="section-nav">
                                <div class="section-nav-title">On this page</div>
                                <div class="section-nav-item active" onclick="scrollToSection('resource-design-and-url-structure')">Resource Design and URL Structure</div>
                                <div class="section-nav-item" onclick="scrollToSection('performance-optimization-techniques')">Performance Optimization</div>
                                <div class="section-nav-item" onclick="scrollToSection('rate-limiting-and-traffic-management')">Rate Limiting and Traffic</div>
                                <div class="section-nav-item" onclick="scrollToSection('security-and-authentication-patterns')">Security and Authentication</div>
                            </div>
                        </div>
                    `
                },
                'Database schema': {
                    question: 'How do you design a database schema for a multi-tenant SaaS application?',
                    response: `
                        <div class="research-container">
                            <div class="research-content">
                                <div class="research-header">
                                    <h1>Multi-Tenant Database Architecture</h1>
                                </div>
                                
                                <div class="research-question">
                                    How do you design a database schema for a multi-tenant SaaS application?
                                </div>
                                
                                <div class="research-answer">
                                    <h2 id="tenant-isolation-strategies">Tenant Isolation Strategies</h2>
                                    <p>Choosing the right isolation level impacts security, performance, and operational complexity throughout your application's lifecycle.</p>
                                    
                                    <h3>Database-per-Tenant Architecture</h3>
                                    <p>Complete isolation provides maximum security and customization flexibility. Salesforce uses this approach for enterprise clients, managing over 100,000 separate databases. Automated provisioning via Terraform or CloudFormation is essential. Connection pooling becomes critical - implement a smart router that maintains pools per tenant. This approach supports compliance requirements like HIPAA and SOC 2 but increases operational overhead by 10x.</p>
                                    
                                    <h3>Schema-per-Tenant Design</h3>
                                    <p>PostgreSQL schemas offer good isolation with lower overhead than separate databases. Atlassian's Confluence uses this pattern, supporting 50,000+ tenants per database instance. Implement row-level security (RLS) as an additional safety layer. Schema migrations require careful orchestration - use tools like Flyway with parallel execution. Monitor schema object limits carefully as PostgreSQL has a 32TB size limit per database.</p>
                                    
                                    <h3>Shared Schema with Row-Level Security</h3>
                                    <p>Most cost-effective for high-volume B2C applications. Shopify processes 1M+ requests/second using shared schemas with tenant_id columns. Implement composite indexes (tenant_id, primary_key) for all tables. Use database features like PostgreSQL's Row Level Security or MySQL's connection attributes for automatic filtering. This approach scales to millions of tenants but requires rigorous testing to prevent data leaks.</p>
                                    
                                    <h2 id="performance-optimization-patterns">Performance Optimization Patterns</h2>
                                    <p>Multi-tenant architectures face unique performance challenges requiring specialized solutions.</p>
                                    
                                    <h3>Indexing Strategies</h3>
                                    <p>Composite indexes with tenant_id as the leading column are crucial for query performance. Implement partial indexes for tenant-specific data patterns - Zendesk reduced query time by 85% using partial indexes. Consider BRIN indexes for time-series data in PostgreSQL, reducing index size by 95%. Monitor index bloat in high-churn environments and schedule regular REINDEX operations during off-peak hours.</p>
                                    
                                    <h3>Sharding and Partitioning</h3>
                                    <p>Horizontal sharding by tenant_id enables linear scaling. Discord shards by guild_id across 1000+ database instances. Implement consistent hashing for shard assignment to minimize data movement during scaling. Table partitioning by date improves performance for time-series data - partition monthly data older than 90 days. Use pg_partman or native partitioning for automated partition management.</p>
                                    
                                    <h2 id="data-migration-and-schema-evolution">Data Migration and Schema Evolution</h2>
                                    <p>Schema changes in multi-tenant environments require careful planning and execution.</p>
                                    
                                    <h3>Zero-Downtime Migrations</h3>
                                    <p>GitHub's scientist pattern enables testing new schemas in production without risk. Implement dual-write patterns during transitions, writing to both old and new schemas. Use feature flags to gradually migrate read traffic. For large tables, use pt-online-schema-change or gh-ost for non-blocking alterations. Plan for 3x storage during migrations and monitor replication lag carefully.</p>
                                    
                                    <h3>Tenant-Specific Customizations</h3>
                                    <p>EAV (Entity-Attribute-Value) patterns enable custom fields but impact performance. JSONB columns in PostgreSQL provide better performance for semi-structured data. Implement a metadata service to track custom fields per tenant. Consider separate extension tables for custom data to maintain query performance on core tables. Limit customizations to prevent schema explosion - Salesforce limits custom objects to 2000 per tenant.</p>
                                    
                                    <h2 id="backup-and-disaster-recovery">Backup and Disaster Recovery</h2>
                                    <p>Multi-tenant architectures require sophisticated backup strategies balancing cost and recovery objectives.</p>
                                    
                                    <h3>Tenant-Level Backup Strategies</h3>
                                    <p>Implement logical backups using pg_dump with --schema flags for PostgreSQL schema isolation. For shared schemas, use COPY commands with WHERE clauses for tenant-specific exports. Continuous archiving with point-in-time recovery enables tenant-specific restores. Store backups in immutable object storage with lifecycle policies. Test restore procedures monthly - Netflix's chaos engineering includes backup failure scenarios.</p>
                                    
                                    <h3>Cross-Region Replication</h3>
                                    <p>Multi-region deployments require careful consistency management. Use PostgreSQL logical replication for selective tenant replication. Implement conflict resolution strategies for multi-master setups. CockroachDB or YugabyteDB provide distributed SQL with built-in multi-region support. Monitor replication lag per tenant and implement automatic failover with health checks. Consider regulatory requirements for data residency when designing replication topology.</p>
                                </div>
                            </div>
                            
                            <div class="section-nav">
                                <div class="section-nav-title">On this page</div>
                                <div class="section-nav-item active" onclick="scrollToSection('tenant-isolation-strategies')">Tenant Isolation Strategies</div>
                                <div class="section-nav-item" onclick="scrollToSection('performance-optimization-patterns')">Performance Optimization</div>
                                <div class="section-nav-item" onclick="scrollToSection('data-migration-and-schema-evolution')">Data Migration and Evolution</div>
                                <div class="section-nav-item" onclick="scrollToSection('backup-and-disaster-recovery')">Backup and Recovery</div>
                            </div>
                        </div>
                    `
                }
            };
            
            const chatData = sampleResponses[chatName] || {
                question: `What is ${chatName.toLowerCase()}?`,
                response: `
                    <div class="research-container">
                        <div class="research-content">
                            <div class="research-header">
                                <h1>${chatName} Analysis</h1>
                            </div>
                            
                            <div class="research-question">
                                What is ${chatName.toLowerCase()}?
                            </div>
                            
                            <div class="research-answer">
                                <h2>Overview</h2>
                                <p>This is a sample deep research response for "${chatName}". In a real application, Caesar would provide comprehensive, well-structured analysis with multiple sections, citations, and detailed explanations.</p>
                                
                                <h2>Key Components</h2>
                                <p>Caesar's responses typically include historical context, current applications, technical details, and future implications of the topic being researched.</p>
                                
                                <h2>Research Methodology</h2>
                                <p>Each response is generated through analysis of multiple sources, fact-checking, and structured presentation to provide maximum value to the user.</p>
                            </div>
                        </div>
                        
                        <div class="section-nav">
                            <div class="section-nav-title">On this page</div>
                            <div class="section-nav-item active">Overview</div>
                            <div class="section-nav-item">Key Components</div>
                            <div class="section-nav-item">Research Methodology</div>
                        </div>
                    </div>
                `
            };
            
            messagesArea.innerHTML = `
                <div class="message ai research-response">
                    <div class="message-content">
                        ${chatData.response}
                    </div>
                </div>
            `;
            
            // Scroll to top of messages area
            messagesArea.scrollTop = 0;
        }

        function newChat() {
            toggleSideNav();
            const messagesArea = document.getElementById('messagesArea');
            const chatContainer = document.querySelector('.chat-container');
            messagesArea.innerHTML = '';
            // Remove has-messages class to center input again
            chatContainer.classList.remove('has-messages');
        }

        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            const messagesArea = document.getElementById('messagesArea');
            
            if (element && messagesArea) {
                // Calculate the position of the element relative to the messages area
                const elementRect = element.getBoundingClientRect();
                const messagesRect = messagesArea.getBoundingClientRect();
                const scrollPosition = messagesArea.scrollTop + elementRect.top - messagesRect.top - 20; // 20px offset
                
                // Smooth scroll to the element
                messagesArea.scrollTo({
                    top: scrollPosition,
                    behavior: 'smooth'
                });
                
                // Update active state of section nav items
                const navItems = document.querySelectorAll('.section-nav-item');
                navItems.forEach(item => item.classList.remove('active'));
                const clickedItem = document.querySelector(`[onclick="scrollToSection('${sectionId}')"]`);
                if (clickedItem) {
                    clickedItem.classList.add('active');
                }
            }
        }

        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            selectedFiles = [...selectedFiles, ...files];
            updateFilePreview();
        }

        function updateFilePreview() {
            const filePreview = document.getElementById('filePreview');
            filePreview.innerHTML = selectedFiles.map((file, index) => `
                <div class="file-preview">
                    📄 ${file.name}
                    <span class="file-remove" onclick="removeFile(${index})">✕</span>
                </div>
            `).join('');
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateFilePreview();
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message || selectedFiles.length > 0) {
                const messagesArea = document.getElementById('messagesArea');
                const chatContainer = document.querySelector('.chat-container');
                
                // Add has-messages class to move input to bottom
                chatContainer.classList.add('has-messages');
                
                // Store the message for the response (but don't display it as a blue bubble)
                
                // Clear input and files
                input.value = '';
                selectedFiles = [];
                updateFilePreview();
                autoResize(input);
                
                // Simulate AI response
                setTimeout(() => {
                    const aiResponse = `
                        <div class="message ai research-response">
                            <div class="message-content">
                                <div class="research-container">
                                    <div class="research-content">
                                        <div class="research-header">
                                            <h1>Response Analysis</h1>
                                        </div>
                                        
                                        <div class="research-question">
                                            ${message}
                                        </div>
                                        
                                        <div class="research-answer">
                                            <p>I've received your message${selectedFiles.length > 0 ? ' and files' : ''}. This is a demo response. In a real application, Caesar would provide a comprehensive, well-structured analysis with multiple sections based on deep research.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    messagesArea.insertAdjacentHTML('beforeend', aiResponse);
                    messagesArea.scrollTop = messagesArea.scrollHeight;
                }, 1000);
                
                messagesArea.scrollTop = messagesArea.scrollHeight;
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }


        function openDocs(type) {
            if (type === 'getting-started') {
                alert('Opening Getting Started docs...');
            } else if (type === 'api') {
                alert('Opening API docs...');
            }
        }

        function shareChat() {
            alert('Share chat functionality - would open share options');
        }

        function openChatMenu() {
            alert('Chat menu - would show options like rename, delete, export, etc.');
        }

        let currentDevice = { name: 'iphone14', width: 390 };

        function switchView(viewType) {
            const appContainer = document.getElementById('appContainer');
            const desktopToggle = document.getElementById('desktopToggle');
            const mobileToggle = document.getElementById('mobileToggle');
            const deviceDropdown = document.getElementById('deviceDropdown');
            
            if (viewType === 'mobile') {
                appContainer.parentElement.classList.add('mobile-view');
                appContainer.parentElement.style.maxWidth = currentDevice.width + 'px';
                desktopToggle.classList.remove('active');
                mobileToggle.classList.add('active');
            } else {
                appContainer.parentElement.classList.remove('mobile-view');
                appContainer.parentElement.style.maxWidth = '';
                desktopToggle.classList.add('active');
                mobileToggle.classList.remove('active');
                deviceDropdown.classList.remove('active');
            }
        }

        function toggleMobileView() {
            const appContainer = document.getElementById('appContainer');
            const deviceDropdown = document.getElementById('deviceDropdown');
            
            if (appContainer.parentElement.classList.contains('mobile-view')) {
                // If already in mobile view, toggle dropdown
                deviceDropdown.classList.toggle('active');
            } else {
                // Switch to mobile view
                switchView('mobile');
                // Show dropdown
                setTimeout(() => {
                    deviceDropdown.classList.add('active');
                }, 100);
            }
        }

        function selectDevice(deviceName, width) {
            const appContainer = document.getElementById('appContainer');
            const deviceDropdown = document.getElementById('deviceDropdown');
            const accountSettings = document.getElementById('accountSettings');
            const backdrop = document.getElementById('accountSettingsBackdrop');
            const detailViews = document.querySelectorAll('.settings-detail-view');
            
            // Update current device
            currentDevice = { name: deviceName, width: width };
            
            // Update mobile view width
            if (appContainer.parentElement.classList.contains('mobile-view')) {
                appContainer.parentElement.style.maxWidth = width + 'px';
                
                // Update Account Settings width
                accountSettings.style.maxWidth = width + 'px';
                backdrop.style.maxWidth = width + 'px';
                
                // Update detail views width
                detailViews.forEach(view => {
                    view.style.maxWidth = width + 'px';
                });
            }
            
            // Update selected state in dropdown
            document.querySelectorAll('.device-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.target.closest('.device-option').classList.add('selected');
            
            // Close dropdown
            deviceDropdown.classList.remove('active');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const deviceDropdown = document.getElementById('deviceDropdown');
            const mobileToggle = document.getElementById('mobileToggle');
            
            if (!mobileToggle.contains(event.target) && !deviceDropdown.contains(event.target)) {
                deviceDropdown.classList.remove('active');
            }
        });

        // Mobile device detection and automatic view setting
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   window.innerWidth <= 768;
        }

        // Initialize view based on device type
        function initializeView() {
            const viewToggle = document.querySelector('.view-toggle');
            const appContainer = document.getElementById('appContainer');
            
            if (isMobileDevice()) {
                // Hide view toggle on mobile devices
                viewToggle.style.display = 'none';
                // Force mobile view
                appContainer.parentElement.classList.add('mobile-view');
                appContainer.parentElement.style.maxWidth = currentDevice.width + 'px';
                document.getElementById('sideNav').classList.add('active');
            } else {
                // Show view toggle on desktop
                viewToggle.style.display = 'flex';
                // Default to desktop view
                switchView('desktop');
            }
        }

        // Close navigation when clicking on chat window in mobile mode
        function setupMobileClickToClose() {
            const chatContainer = document.querySelector('.chat-container');
            const sideNav = document.getElementById('sideNav');
            const appContainer = document.getElementById('appContainer');
            
            if (chatContainer) {
                chatContainer.addEventListener('click', function(e) {
                    // Check if we're in mobile view mode (either actual mobile device or desktop mobile preview)
                    const isInMobileMode = isMobileDevice() || appContainer.parentElement.classList.contains('mobile-view');
                    
                    // Only when in mobile mode and navigation is open
                    if (isInMobileMode && sideNav.classList.contains('active')) {
                        // Don't close if clicking on the burger menu itself
                        if (!e.target.closest('.mobile-burger-menu')) {
                            toggleSideNav();
                        }
                    }
                });
            }
        }

        // Account Settings Functions
        function openAccountSettings() {
            const appContainer = document.getElementById('appContainer');
            const isMobileView = isMobileDevice() || appContainer.parentElement.classList.contains('mobile-view');
            
            // Only allow opening settings in mobile view
            if (!isMobileView) {
                alert('Account Settings is currently only available in mobile view');
                return;
            }
            
            const accountSettings = document.getElementById('accountSettings');
            const backdrop = document.getElementById('accountSettingsBackdrop');
            const sideNav = document.getElementById('sideNav');
            
            // Close navigation in mobile view
            if (sideNav.classList.contains('active')) {
                toggleSideNav();
            }
            
            accountSettings.classList.add('active');
            backdrop.classList.add('active');
        }

        function closeAccountSettings() {
            const accountSettings = document.getElementById('accountSettings');
            const backdrop = document.getElementById('accountSettingsBackdrop');
            accountSettings.classList.remove('active');
            backdrop.classList.remove('active');
        }

        // Username Edit Functions
        function openUsernameEdit() {
            const usernameEditView = document.getElementById('usernameEditView');
            usernameEditView.classList.add('active');
        }

        function closeUsernameEdit() {
            const usernameEditView = document.getElementById('usernameEditView');
            usernameEditView.classList.remove('active');
        }

        function saveUsername() {
            const usernameInput = document.getElementById('usernameInput');
            const newUsername = usernameInput.value.trim();
            
            if (newUsername) {
                // Update the username display in the main settings
                const usernameDisplay = document.querySelector('.settings-item[onclick="openUsernameEdit()"] .settings-item-value');
                if (usernameDisplay) {
                    usernameDisplay.textContent = newUsername;
                }
                
                alert('Username saved successfully');
                closeUsernameEdit();
            } else {
                alert('Please enter a valid username');
            }
        }

        function deleteAccount() {
            if (confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
                alert('Account deletion would be processed here');
            }
        }

        // Language Selector Functions
        function openLanguageSelector() {
            const languageSelectorView = document.getElementById('languageSelectorView');
            languageSelectorView.classList.add('active');
        }

        function closeLanguageSelector() {
            const languageSelectorView = document.getElementById('languageSelectorView');
            languageSelectorView.classList.remove('active');
        }

        function selectLanguage(lang) {
            // Remove selected class from all options
            document.querySelectorAll('.language-option').forEach(option => {
                option.classList.remove('selected');
                const checkmark = option.querySelector('.checkmark');
                if (checkmark) checkmark.remove();
            });
            
            // Add selected class to clicked option
            event.target.closest('.language-option').classList.add('selected');
            
            // Add checkmark
            const checkmark = document.createElement('span');
            checkmark.className = 'checkmark';
            checkmark.textContent = '✓';
            event.target.closest('.language-option').appendChild(checkmark);
            
            // Update the language display in settings
            const languageDisplay = document.querySelector('.settings-item[onclick="openLanguageSelector()"] .settings-item-value');
            const languageName = event.target.closest('.language-option').querySelector('.language-name').textContent;
            if (languageDisplay) {
                languageDisplay.textContent = languageName;
            }
            
            // Close language selector
            setTimeout(() => {
                closeLanguageSelector();
            }, 300);
        }

        // Other Settings Functions
        function connectTwitter() {
            alert('Twitter connection flow would start here');
        }

        function openTerms() {
            alert('Terms & Conditions would open here');
        }

        function manageCookies() {
            alert('Cookie management would open here');
        }

        function openSupport() {
            window.open('https://t.me/support', '_blank');
        }

        function logout() {
            if (confirm('Are you sure you want to log out?')) {
                alert('Logout would be processed here');
            }
        }

        // Handle scroll blur effect
        function handleMainPageScroll() {
            const mainNavigation = document.querySelector('.main-navigation');
            const mainPage = document.getElementById('mainPage');
            
            if (mainPage && mainPage.style.display !== 'none') {
                if (window.scrollY > 50) {
                    mainNavigation.classList.add('scrolled');
                } else {
                    mainNavigation.classList.remove('scrolled');
                }
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeView();
            setupMobileClickToClose();
            // Hide view toggle on initial load (main page is shown)
            const viewToggle = document.querySelector('.view-toggle');
            if (viewToggle) viewToggle.style.display = 'none';
            // Ensure body is not in prototype mode on initial load
            document.body.classList.remove('prototype-mode');
            // Add scroll listener for main page blur effect
            window.addEventListener('scroll', handleMainPageScroll);
        });
        window.addEventListener('resize', initializeView);

        // Navigation functions for main page
        function openPrototype(view = 'mobile') {
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('prototypeContainer').style.display = 'block';
            
            // Enable prototype mode (prevents body scrolling)
            document.body.classList.add('prototype-mode');
            
            // Set the view based on parameter
            const appContainer = document.getElementById('appContainer');
            if (view === 'mobile') {
                appContainer.parentElement.classList.add('mobile-view');
            } else {
                appContainer.parentElement.classList.remove('mobile-view');
            }
            
            // Show view toggle when entering prototype
            const viewToggle = document.querySelector('.view-toggle');
            if (viewToggle) viewToggle.style.display = 'flex';
        }

        function backToMain() {
            document.getElementById('prototypeContainer').style.display = 'none';
            document.getElementById('mainPage').style.display = 'block';
            
            // Disable prototype mode (allows body scrolling)
            document.body.classList.remove('prototype-mode');
            
            // Hide view toggle when returning to main
            const viewToggle = document.querySelector('.view-toggle');
            if (viewToggle) viewToggle.style.display = 'none';
            // Close navigation if open
            const sideNav = document.getElementById('sideNav');
            if (sideNav.classList.contains('active')) {
                toggleSideNav();
            }
        }

        // Admin Settings functions
        function openAdminSettings() {
            const password = prompt('Enter admin password:');
            
            // Simple password check (in a real app, this would be properly secured)
            if (password === 'admin123') {
                document.getElementById('mainPage').style.display = 'none';
                document.getElementById('adminSettingsContainer').style.display = 'block';
            } else if (password !== null) { // User didn't cancel
                alert('Incorrect password. Access denied.');
            }
        }

        function backToMainFromAdmin() {
            document.getElementById('adminSettingsContainer').style.display = 'none';
            document.getElementById('mainPage').style.display = 'block';
        }
    </script>
        <!-- Account Settings Backdrop -->
        <div class="account-settings-backdrop" id="accountSettingsBackdrop" onclick="closeAccountSettings()"></div>
        
        <!-- Account Settings Container -->
        <div class="account-settings-container" id="accountSettings">
        <div class="settings-header">
            <h2 class="settings-title">Settings</h2>
            <button class="settings-close-btn" onclick="closeAccountSettings()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        
        <div class="settings-content">
            <!-- Account Section -->
            <div class="settings-section-title">ACCOUNT</div>
            <div class="settings-section">
                <div class="settings-item tappable" onclick="openUsernameEdit()">
                    <div class="settings-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                    <div class="settings-item-left">
                        <div class="settings-item-label">Username</div>
                        <div class="settings-item-value">JohnHughes</div>
                    </div>
                    <span class="settings-item-arrow">›</span>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                            <path d="m22 7-10 5L2 7"></path>
                        </svg>
                    </div>
                    <div class="settings-item-left">
                        <div class="settings-item-label">Email</div>
                        <div class="settings-item-value">john@example.com</div>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                            <polyline points="3.29 7 12 12 20.71 7"></polyline>
                            <line x1="12" y1="22" x2="12" y2="12"></line>
                        </svg>
                    </div>
                    <div class="settings-item-left">
                        <div class="settings-item-label">Wallet address</div>
                        <div class="settings-item-value">0x742d...8963</div>
                    </div>
                </div>
                
                <div class="settings-item tappable" onclick="connectTwitter()">
                    <div class="settings-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                    </div>
                    <div class="settings-item-left">
                        <div class="settings-item-label">Connect X (Twitter)</div>
                    </div>
                    <button class="connect-button" onclick="connectTwitter(); event.stopPropagation();">Connect</button>
                </div>
            </div>
            
            <!-- App Section -->
            <div class="settings-section-title">APP</div>
            <div class="settings-section">
                <div class="settings-item tappable" onclick="openLanguageSelector()">
                    <div class="settings-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"></path>
                            <path d="M2 12h20"></path>
                        </svg>
                    </div>
                    <div class="settings-item-left">
                        <div class="settings-item-label">Language</div>
                        <div class="settings-item-value">English</div>
                    </div>
                    <span class="settings-item-arrow">›</span>
                </div>
            </div>
            
            <!-- About Section -->
            <div class="settings-section-title">ABOUT</div>
            <div class="settings-section">
                <div class="settings-item tappable" onclick="openTerms()">
                    <div class="settings-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                    </div>
                    <div class="settings-item-left">
                        <div class="settings-item-label">Terms & Conditions</div>
                    </div>
                    <span class="settings-item-arrow">›</span>
                </div>
                
                <div class="settings-item tappable" onclick="manageCookies()">
                    <div class="settings-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
                            <circle cx="12" cy="12" r="2"></circle>
                            <path d="M12 10V2"></path>
                            <path d="M10 12H2"></path>
                            <path d="M14 12h8"></path>
                            <path d="M12 14v8"></path>
                        </svg>
                    </div>
                    <div class="settings-item-left">
                        <div class="settings-item-label">Manage Cookies</div>
                    </div>
                    <span class="settings-item-arrow">›</span>
                </div>
                
                <div class="settings-item tappable" onclick="openSupport()">
                    <div class="settings-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                            <circle cx="12" cy="10" r="1"></circle>
                            <path d="M12 13v3"></path>
                        </svg>
                    </div>
                    <div class="settings-item-left">
                        <div class="settings-item-label">Support (Telegram)</div>
                    </div>
                    <span class="settings-item-arrow">›</span>
                </div>
            </div>
        </div>
        
        <!-- Fixed Logout Button -->
        <div class="settings-logout-container">
            <button class="logout-button" onclick="logout()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Log out
            </button>
        </div>
    </div>
    
    <!-- Username Edit Detail View -->
    <div class="settings-detail-view" id="usernameEditView">
        <div class="detail-view-header">
            <button class="settings-back-btn" onclick="closeUsernameEdit()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
            </button>
            <h2 class="settings-title">Edit Username</h2>
        </div>
        
        <div class="detail-view-content">
            <div class="username-input-container">
                <input type="text" class="username-input" value="JohnHughes" id="usernameInput">
            </div>
            
            <!-- Fixed buttons at bottom -->
            <div class="username-edit-buttons">
                <button class="save-button" onclick="saveUsername()">Save</button>
                <button class="delete-account-button" onclick="deleteAccount()">Delete Account</button>
            </div>
        </div>
    </div>
    
    <!-- Language Selector Detail View -->
    <div class="settings-detail-view" id="languageSelectorView">
        <div class="detail-view-header">
            <button class="settings-back-btn" onclick="closeLanguageSelector()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
            </button>
            <h2 class="settings-title">Language</h2>
        </div>
        
        <div class="detail-view-content">
            <div class="language-option selected" onclick="selectLanguage('en')">
                <div>
                    <div class="language-name">English</div>
                    <div class="language-native">English</div>
                </div>
                <span class="checkmark">✓</span>
            </div>
            
            <div class="language-option" onclick="selectLanguage('es')">
                <div>
                    <div class="language-name">Spanish</div>
                    <div class="language-native">Español</div>
                </div>
            </div>
            
            <div class="language-option" onclick="selectLanguage('fr')">
                <div>
                    <div class="language-name">French</div>
                    <div class="language-native">Français</div>
                </div>
            </div>
            
            <div class="language-option" onclick="selectLanguage('de')">
                <div>
                    <div class="language-name">German</div>
                    <div class="language-native">Deutsch</div>
                </div>
            </div>
            
            <div class="language-option" onclick="selectLanguage('it')">
                <div>
                    <div class="language-name">Italian</div>
                    <div class="language-native">Italiano</div>
                </div>
            </div>
            
            <div class="language-option" onclick="selectLanguage('ja')">
                <div>
                    <div class="language-name">Japanese</div>
                    <div class="language-native">日本語</div>
                </div>
            </div>
            
            <div class="language-option" onclick="selectLanguage('zh')">
                <div>
                    <div class="language-name">Chinese</div>
                    <div class="language-native">中文</div>
                </div>
            </div>
        </div>
    </div>
    
    </div> <!-- Close app-container -->
    </div> <!-- Close prototype-container -->
</body>
</html>